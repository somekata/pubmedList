# PubMed CSV Viewer

PubMed からダウンロードした CSV ファイルを用いて、  
論文業績を **集計・可視化・整形・出力** するための Web ベース Viewer です。

研究室内での業績整理、年次報告資料の作成、学内提出用データ整理などを想定しています。

---

## 特徴

- PubMed CSV をそのまま読み込み可能
- 年次集計表・棒グラフ・年別一覧を自動生成
- 著者の強調表示（太字／下線／両方）に対応
- 著者数が多くても使いやすい絞り込み・検索機能
- HTML / PDF / Word（互換HTML） / TXT 出力に対応
- ブラウザのみで動作（サーバ不要）

---

## 使い方

### 1. PubMed で CSV を取得

1. PubMed にアクセスし、検索条件（著者名・所属・年など）で論文を絞り込みます
2. 検索結果画面で **Save** をクリック
3. **Selection** で対象（すべて／選択した論文など）を選択
4. **Format** で一番下の **CSV** を選択
5. **Create file** をクリックして CSV ファイルを保存

---

### 2. CSV ファイルを読み込む

- Viewer の「ファイルを選択」に
  - CSV ファイルを **ドラッグ＆ドロップ**
  - またはクリックして選択
- 読み込み後、メイン画面に集計結果が表示されます

---

### 3. メイン画面で確認

- 年次集計表
- 年次棒グラフ
- 年別一覧（Authors / Title / Citation）

を確認します。

著者の強調表示や表示年の範囲は随時調整できます。

---

### 4. 入力画面で設定

以下の情報を入力できます：

- 表題
- 備考
- 作成日（カレンダー入力）

これらは出力ファイルに反映されます。

---

### 5. 出力画面で出力

1. 出力する内容を選択
   - 年次集計表
   - グラフ
   - 一覧
2. 出力形式を選択
   - HTML
   - PDF
   - Word（互換HTML）
   - TXT
3. 出力名を入力し、出力ボタンを押します

---

## 出力形式について

### HTML

- 完全なスタンドアロン HTML
- グラフは画像として埋め込み

### PDF

- ブラウザの印刷機能を使用
- 印刷用 CSS 対応済み
- グラフは画像として表示

### Word（互換HTML）

- **実体は HTML 形式**です
- 拡張子：`.doc.html`
- Microsoft Word / LibreOffice / Google Docs で開けます
- ※ 本物の `.docx` 形式ではありません

### TXT

- タブ区切りの表
- 年別リスト形式
- 他ツールへの再利用に適しています

---

## 技術構成

- HTML / CSS / JavaScript のみ
- 外部ライブラリ不使用
- ファイル構成：
  index.html
  style.css
  script.js // 表示・集計・UI
  output.js // 出力処理（HTML / PDF / Word / TXT）

---

## 注意事項・制限

- グラフは `<canvas>` を使用しているため、  
  出力時は画像に変換しています
- Word 出力は互換HTML形式です（docx ではありません）
- PubMed CSV の列構成に依存します  
  （Authors / Title / Citation / Publication Year など）

---

## 今後の拡張予定（構想）

- 出力ログ表示
- table 形式一覧のソート・フィルター強化
- 英語版 UI / README
- 本物の DOCX 出力（必要に応じて）

---

## ライセンス

研究・教育用途での利用を想定しています。  
必要に応じて各自の環境・用途に合わせて改変してください。

---

## クレジット

Created with assistance from ChatGPT
